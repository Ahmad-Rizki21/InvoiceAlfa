(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"0667":function(e,t,n){"use strict";n("3fef")},"0eb4":function(e,t,n){"use strict";n("a463")},"3fef":function(e,t,n){},9954:function(e,t,n){},a463:function(e,t,n){},cbb5:function(e,t,n){"use strict";n.r(t);n("ac1f"),n("841c"),n("4de4"),n("d3b7"),n("d81d"),n("b0c0"),n("e260"),n("ddb0"),n("e439");var a=function(){var e=this,t=e._self._c;return t("q-page",{staticClass:"page-invoices"},[t("portal",{attrs:{to:"app-breadcrumbs"}},[t("breadcrumbs")],1),t("portal",{attrs:{to:"app-toolbar"}},[t("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){return e.$store.dispatch("app/toggleSidebar")}}}),t("q-toolbar-title",[e._v("\n      "+e._s(e.$t("Invoices"))+"\n    ")]),t("div",{staticClass:"sep"}),e.$auth.can("create.invoice")?t("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"add"}}):e._e()],1),t("div",{staticClass:"page-header"},[t("q-toolbar-title",[e._v(e._s(e.$t("Invoices")))]),t("div",{staticClass:"sep"}),e.$auth.can("create.invoice")?t("q-btn",{staticClass:"q-ml-sm q-btn-lg btn-page-invoices-export",attrs:{color:"secondary",loading:e.isExporting,icon:"system_update_alt"},on:{click:e.onFormEntryExport}},[t("span",{staticClass:"q-ml-sm"},[e._v(e._s(e.$t("Export")))])]):e._e(),e.$auth.can("create.invoice")?t("q-btn",{staticClass:"q-btn-lg btn-page-invoices-create q-ml-md",attrs:{color:"primary",icon:"add"},on:{click:e.onFormEntryCreate}},[t("span",{staticClass:"q-ml-xs"},[e._v(e._s(e.$t("New {entity}",{entity:e.$t("Invoice")})))])]):e._e()],1),t("div",{staticClass:"page-body"},[t("q-card",[t("q-toolbar",[t("div",{staticClass:"col col-md-3 col-lg-2 quick-search-datatable"},[t("q-input",{attrs:{label:e.$t("Search {entity}",{entity:e.$t("no")}),"stack-label":"",debounce:300,dense:"",clearable:"","clear-icon":"close"},on:{input:function(t){return e.onRequest()}},model:{value:e.search.fuzzy.value,callback:function(t){e.$set(e.search.fuzzy,"value",t)},expression:"search.fuzzy.value"}})],1),t("div",{staticClass:"col col-md-3 col-lg-2 q-ml-auto row"},[t("q-btn",{staticClass:"q-ml-auto btn-datatable-advanced-search",attrs:{unelevated:"",color:"default",size:"sm",icon:"search",disable:e.isLoading},on:{click:e.onAdvancedSearch}},[e._v("\n            "+e._s(e.$t("Advanced Search"))+"\n          ")]),t("q-btn",{staticClass:"q-ml-sm btn-datatable-view-columns",attrs:{unelevated:"",color:"default",size:"sm",padding:"xs",icon:"view_column"}},[t("q-tooltip",[e._v("\n              "+e._s(e.$t("View Column"))+"\n            ")]),t("q-menu",[t("div",{staticClass:"row no-wrap q-pa-md",staticStyle:{"min-width":"200px"}},[t("div",{staticClass:"column"},[t("q-option-group",{staticStyle:{"margin-left":"-16px"},attrs:{options:e.columns.map((function(e){return{label:e.realLabel||e.label,value:e.name}})).filter((function(e){return e.label})),type:"checkbox",size:"xs"},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}})],1)])])],1)],1)]),t("q-table",{ref:"table",attrs:{data:e.entries,columns:e.columns,"visible-columns":e.visibleColumns,loading:e.isLoading,pagination:e.pagination,selection:"multiple",selected:e.selectedEntries,"binary-state-sort":"","row-key":"id"},on:{"update:pagination":function(t){e.pagination=t},"update:selected":function(t){e.selectedEntries=t},request:e.onRequest,selection:e.onSelection},scopedSlots:e._u([{key:"top",fn:function(){return[t("q-btn",{attrs:{unelevated:"",color:"primary",icon:"print",disable:!e.selectedEntries.length},on:{click:function(t){e.isAdapterPrinterVisible=!0}}},[t("span",{staticClass:"q-ml-sm"},[e._v(e._s(e.$t("Print")))])]),t("q-btn",{staticClass:"q-ml-sm",attrs:{unelevated:"",color:"default",icon:"delete",padding:"sm",disable:!e.selectedEntries.length}}),t("span",{staticClass:"q-px-md q-py-sm",class:{"text-default":!e.selectedEntries.length}},[e._v("\n            "+e._s(e.$q.lang.table.selectedRecords(e.selectedEntries.length))+"\n          ")])]},proxy:!0},{key:"header-selection",fn:function(n){return[t("q-checkbox",{model:{value:n.selected,callback:function(t){e.$set(n,"selected",t)},expression:"scope.selected"}})]}},{key:"body-selection",fn:function(e){return[t("q-checkbox",{attrs:{value:e.selected},on:{input:function(t,n){Object.getOwnPropertyDescriptor(e,"selected").set(t,n)}}})]}},{key:"body-cell-id",fn:function(n){var a=n.rowIndex;return[t("q-td",[e._v(e._s(a+1))])]}},{key:"body-cell-status",fn:function(e){var n=e.row;return[t("q-td",{staticClass:"text-center"},[t("invoice-status-chip",{attrs:{invoice:n,dense:""}})],1)]}},{key:"body-cell-action",fn:function(n){var a=n.row;return[t("q-td",{staticClass:"text-right table-cell-action"},[t("q-btn",{staticClass:"btn-datatable-view-invoice",attrs:{unelevated:"",color:"default",size:"sm",padding:"xs",icon:"visibility"},on:{click:function(t){return t.preventDefault(),e.onView(a)}}},[t("q-tooltip",[e._v("\n                "+e._s(e.$t("View"))+"\n              ")])],1),e.$auth.can("delete.invoice")?t("q-btn",{staticClass:"q-ml-xs btn-datatable-delete-invoice",attrs:{unelevated:"",color:"default",size:"sm",padding:"xs",icon:"delete"},on:{click:function(t){return t.preventDefault(),e.onDelete(a)}}},[t("q-tooltip",[e._v("\n                "+e._s(e.$t("Delete"))+"\n              ")])],1):e._e()],1)]}},{key:"no-data",fn:function(n){var a=n.icon,r=n.message,s=n.filter;return[t("div",{staticClass:"full-width row flex-center text-center q-gutter-sm"},[t("q-icon",{attrs:{size:"2em",name:s?"filter_b_and_w":a}}),t("span",[e._v("\n              "+e._s(r)+"\n            ")])],1)]}}])})],1)],1),t("q-dialog",{model:{value:e.isAdvancedSearchVisible,callback:function(t){e.isAdvancedSearchVisible=t},expression:"isAdvancedSearchVisible"}},[t("q-card",{staticClass:"q-pa-sm"},[t("q-form",{on:{submit:function(t){return t.preventDefault(),e.onAdvancedSearchSubmit.apply(null,arguments)}}},[t("q-card-section",{staticClass:"q-pb-xs"},[t("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("Search")))])]),t("q-card-section",{staticClass:"q-mb-md"},[t("q-input",{attrs:{label:e.$t("Search {entity}",{entity:e.$t("name")}),outlined:"",dense:""},model:{value:e.advancedSearch.fuzzy.value,callback:function(t){e.$set(e.advancedSearch.fuzzy,"value",t)},expression:"advancedSearch.fuzzy.value"}})],1),t("q-separator"),t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:e.$t("Cancel"),flat:""}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{type:"submit",label:e.$t("Search"),color:"default",unelevated:""}})],1)],1)],1)],1),t("q-dialog",{attrs:{persistent:!e.isFormEntryReadonly},model:{value:e.isFormEntryVisible,callback:function(t){e.isFormEntryVisible=t},expression:"isFormEntryVisible"}},[t("form-entry",{attrs:{entry:e.formEntry,readonly:e.isFormEntryReadonly,loading:e.isLoading},on:{success:e.onFormEntrySuccess,cancel:e.onFormEntryCancel}})],1),t("q-dialog",{attrs:{persistent:!e.isFormEntryReadonly},model:{value:e.isFormEntryVisible,callback:function(t){e.isFormEntryVisible=t},expression:"isFormEntryVisible"}},[t("form-entry",{attrs:{entry:e.formEntry,readonly:e.isFormEntryReadonly,loading:e.isLoading},on:{success:e.onFormEntrySuccess,cancel:e.onFormEntryCancel}})],1),t("q-dialog",{attrs:{persistent:""},model:{value:e.isFormPasswordVisible,callback:function(t){e.isFormPasswordVisible=t},expression:"isFormPasswordVisible"}},[t("form-password",{attrs:{entry:e.formPassword,loading:e.isLoading},on:{success:e.onFormPasswordSuccess,cancel:e.onFormPasswordCancel}})],1),t("q-dialog",{attrs:{persistent:""},model:{value:e.isAdapterPrinterVisible,callback:function(t){e.isAdapterPrinterVisible=t},expression:"isAdapterPrinterVisible"}},[t("adapter-printer",{attrs:{visible:e.isAdapterPrinterVisible,entries:e.selectedEntries,loading:e.isLoading},on:{success:e.onAdapterPrinterSuccess,cancel:e.onAdapterPrinterCancel}})],1),e.exportUrl?t("a",{ref:"exportHiddenLink",staticStyle:{display:"none"},attrs:{href:e.exportUrl,download:""}}):e._e()],1)},r=[],s=n("278c"),i=n.n(s),o=n("ded3"),l=n.n(o),c=n("7ec2"),d=n.n(c),u=n("c973"),p=n.n(u),m=(n("b64b"),n("e9c4"),n("14d9"),n("fb6a"),n("99af"),n("caad"),n("2532"),n("bd4c")),f=function(){var e=this,t=e._self._c;return t("q-card",{staticClass:"form-entry q-pa-sm",class:{readonly:e.readonly}},[t("q-form",{ref:"form",staticClass:"q-gutter-md",attrs:{greedy:""},on:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)}}},[e.readonly?e._e():t("div",{staticClass:"text-h6 q-px-md q-pt-sm"},[e._v("\n      "+e._s(e.$t("".concat(e.isCreate?"Create":"Update"," {entity}"),{entity:e.$t("Customer")}))+"\n    ")]),t("q-card-section",{staticClass:"q-mb-md"},[t("div",{staticClass:"q-mb-md text-subtitle text-weight-bold"},[e._v(e._s(e.$t("Details")))]),t("div",{staticClass:"row q-col-gutter-sm"},[t("div",{staticClass:"col-xs-12 col-md-8"},[t("q-input",{attrs:{label:e.$t("Name")+"*",filled:!e.readonly,borderless:e.readonly,readonly:e.readonly,dense:"",name:"name",autocomplete:"off",rules:e.rules.name,error:!!e.errors.name,"error-message":e.errors.name},model:{value:e.formEntry.name,callback:function(t){e.$set(e.formEntry,"name",t)},expression:"formEntry.name"}})],1),t("div",{staticClass:"col-xs-12 col-md-4"},[t("q-input",{attrs:{label:e.$t("Terminal Name")+"*",filled:!e.readonly,borderless:e.readonly,readonly:e.readonly,name:"terminal_name",autocomplete:"off",dense:"",rules:e.rules.terminal_name,error:!!e.errors.terminal_name,"error-message":e.errors.terminal_name},model:{value:e.formEntry.terminal_name,callback:function(t){e.$set(e.formEntry,"terminal_name",t)},expression:"formEntry.terminal_name"}})],1),t("div",{staticClass:"col-xs-12 col-sm-5 col-md-4"},[t("q-input",{attrs:{label:e.$t("Online At"),filled:!e.readonly,name:"online_at",autocomplete:"off",borderless:e.readonly,readonly:e.readonly,dense:"",rules:e.rules.online_at,error:!!e.errors.online_at,"error-message":e.errors.online_at,mask:"##/##/####",hint:e.$utils.isDateValid(e.formEntry.online_at)?void 0:e.$t("Valid format: DD/MM/YYYYY")},scopedSlots:e._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{minimal:"",mask:"DD/MM/YYYY"},model:{value:e.formEntry.online_at,callback:function(t){e.$set(e.formEntry,"online_at",t)},expression:"formEntry.online_at"}},[t("div",{staticClass:"row items-center justify-end"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.formEntry.online_at,callback:function(t){e.$set(e.formEntry,"online_at",t)},expression:"formEntry.online_at"}})],1),t("div",{staticClass:"col-xs-12 col-md-8 col-lg-7"},[t("div",{staticClass:"q-mb-md text-subtitle text-weight-bold"},[e._v(e._s(e.$t("Coordinate")))]),t("div",{staticClass:"row q-col-gutter-sm"},[t("div",{staticClass:"col-xs-12 col-md-6"},[t("q-input",{staticClass:"no-arrows",attrs:{label:e.$t("Latitude"),filled:!e.readonly,type:"number",step:"any",name:"latitude",autocomplete:"off",borderless:e.readonly,readonly:e.readonly,dense:"",rules:e.rules.latitude,error:!!e.errors.latitude,"error-message":e.errors.latitude},model:{value:e.formEntry.latitude,callback:function(t){e.$set(e.formEntry,"latitude",t)},expression:"formEntry.latitude"}})],1),t("div",{staticClass:"col-xs-12 col-md-6"},[t("q-input",{staticClass:"no-arrows",attrs:{label:e.$t("Longitude"),filled:!e.readonly,type:"number",step:"any",name:"longitude",autocomplete:"off",borderless:e.readonly,readonly:e.readonly,dense:"",rules:e.rules.longitude,error:!!e.errors.longitude,"error-message":e.errors.longitude},model:{value:e.formEntry.longitude,callback:function(t){e.$set(e.formEntry,"longitude",t)},expression:"formEntry.longitude"}})],1)])]),t("div",{staticClass:"col-xs-12"},[t("div",{staticClass:"q-mb-md text-subtitle text-weight-bold"},[e._v(e._s(e.$t("PIC")))]),t("div",{staticClass:"row q-col-gutter-sm"},[t("div",{staticClass:"col-xs-12 col-md-7"},[t("q-input",{attrs:{label:e.$t("PIC Name"),filled:!e.readonly,rows:"1",name:"pic_name",autocomplete:"off",borderless:e.readonly,readonly:e.readonly,dense:"",rules:e.rules.pic_name,error:!!e.errors.pic_name,"error-message":e.errors.pic_name},model:{value:e.formEntry.pic_name,callback:function(t){e.$set(e.formEntry,"pic_name",t)},expression:"formEntry.pic_name"}})],1),t("div",{staticClass:"col-xs-12 col-md-5"},[t("q-input",{attrs:{label:e.$t("PIC Phone Number"),filled:!e.readonly,rows:"1",name:"pic_phone_number",autocomplete:"off",borderless:e.readonly,readonly:e.readonly,dense:"",rules:e.rules.pic_phone_number,error:!!e.errors.pic_phone_number,"error-message":e.errors.pic_phone_number},model:{value:e.formEntry.pic_phone_number,callback:function(t){e.$set(e.formEntry,"pic_phone_number",t)},expression:"formEntry.pic_phone_number"}})],1)])]),e.readonly?e._e():t("div",{staticClass:"col-xs-12"},[t("q-toggle",{attrs:{label:e.formEntry.status?e.$t("Active"):e.$t("Inactive"),name:"status"},model:{value:e.formEntry.status,callback:function(t){e.$set(e.formEntry,"status",t)},expression:"formEntry.status"}})],1),e.readonly?[t("div",{staticClass:"col-xs-12"},[t("q-input",{attrs:{value:e.formEntry.status?e.$t("Active"):e.$t("Inactive"),label:e.$t("Status"),borderless:"",readonly:"",dense:""}})],1),t("div",{staticClass:"col-xs-12"},[t("q-input",{attrs:{value:e.formEntry.created_at,label:e.$t("Created At"),borderless:"",readonly:"",dense:""}})],1)]:e._e()],2)]),t("q-separator"),e.readonly?t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{attrs:{label:e.$t("Close"),flat:"",disable:e.loading||e.isLoading},on:{click:e.cancel}})],1):t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{attrs:{label:e.$t("Cancel"),flat:"",disable:e.loading||e.isLoading},on:{click:e.cancel}}),t("q-btn",{staticClass:"q-px-lg",attrs:{type:"submit",label:e.$t("".concat(e.isCreate?"Create":"Save")),color:e.isCreate?"positive":"primary",loading:e.loading||e.isLoading,unelevated:""}})],1)],1)],1)},b=[],v=(n("cb29"),n("5319"),n("00b4"),{terminal_name:null,location:null,mttr_hour:null,mttr_minute:null,total_time_hour:null,total_time_minute:null,online_at:null,latitude:null,longitude:null,pic_name:null,pic_phone_number:null,pic_phone_number2:null,status:1}),h={name:"FormEntry",props:{loading:Boolean,closable:{type:Boolean,default:!0},entry:{type:Object,default:function(){return v}},readonly:{type:Boolean,default:!1}},data:function(){var e=this;return{formEntry:v,isLoading:!1,rules:{terminal_name:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Terminal name")})}],location:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Location")})}],online_at:[function(t){return!t||!!t&&e.$utils.isDateValid(t)||e.$t("{field} is invalid",{field:e.$t("Online at")})}],latitude:[],longitude:[],pic_name:[],pic_phone_number:[],sla:[]},errors:v}},computed:{isCreate:function(){return!this.formEntry.id}},watch:{entry:{immediate:!0,handler:function(e){var t=this;this.$nextTick((function(){t.fill(e)}))}}},methods:{fill:function(e){e=l()(l()({},v),e),e.created_at&&(e.created_at=m["b"].formatDate(e.created_at,"DD MMM YYYY HH:mm")),e.online_at&&(e.online_at=m["b"].formatDate(e.online_at,"DD/MM/YYYY")),e.status=Boolean(parseInt(e.status,10)),this.formEntry=e,this.$refs.form.resetValidation()},onSubmit:function(){var e=this;return p()(d()().mark((function t(){var n,a,r,s,i,o;return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading&&!e.isLoading){t.next=2;break}return t.abrupt("return");case 2:if(!e.readonly){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.$refs.form.validate();case 6:if(n=t.sent,n){t.next=9;break}return t.abrupt("return");case 9:return a=l()({},e.formEntry),a.status=a.status?1:0,e.$utils.isDateValid(a.online_at)&&(a.online_at=m["b"].formatDate(m["b"].extractDate(a.online_at,"DD/MM/YYYY"),"YYYY-MM-DD")),delete a.mttr_hour,delete a.mttr_minute,delete a.total_time_hour,delete a.total_time_minute,e.isLoading=!0,t.prev=17,r=a.id?"/v1/customers/".concat(a.id):"/v1/customers",s=a.id?"patch":"post",t.next=22,e.$api[s](r,a);case 22:i=t.sent,o=i.data,"success"===o.status&&e.$emit("success"),o.message?e.$q.notify({message:o.message}):"success"===o.status?e.$q.notify({message:e.$t("{entity} saved",{entity:e.$t("Customer")})}):e.$t("Failed to save {entity}",{entity:e.$t("customer")}),t.next=31;break;case 28:t.prev=28,t.t0=t["catch"](17),t.t0.validation?e.errors=l()(l()({},v),t.t0.validation.errors):e.$q.notify(t.t0);case 31:e.isLoading=!1;case 32:case"end":return t.stop()}}),t,null,[[17,28]])})))()},cancel:function(){this.loading||this.isLoading||this.$emit("cancel")},onDoubleInputChildKeydown:function(e){var t=String(e.target.value).replace(/[^0-9]/g,""),n=/^[0-9]$/i.test(e.key);n&&(t="".concat(t).concat(e.key)),(t>59||String(t).length>2)&&n&&e.preventDefault()}}},y=h,g=(n("dfde"),n("2877")),_=n("f09f"),$=n("0378"),w=n("a370"),C=n("27f9"),x=n("0016"),q=n("7cbe"),E=n("52ee"),k=n("9c40"),P=n("9564"),S=n("eb85"),F=n("4b7e"),D=n("7f67"),A=n("eebe"),Q=n.n(A),V=Object(g["a"])(y,f,b,!1,null,"2b770b5b",null),L=V.exports;Q()(V,"components",{QCard:_["a"],QForm:$["a"],QCardSection:w["a"],QInput:C["a"],QIcon:x["a"],QPopupProxy:q["a"],QDate:E["a"],QBtn:k["a"],QToggle:P["a"],QSeparator:S["a"],QCardActions:F["a"]}),Q()(V,"directives",{ClosePopup:D["a"]});var Y=function(){var e=this,t=e._self._c;return t("q-card",{staticClass:"form-entry q-pa-sm"},[t("q-form",{ref:"form",staticClass:"q-gutter-md",attrs:{greedy:""},on:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)}}},[t("div",{staticClass:"text-h6 q-px-md q-pt-sm"},[e._v("\n      "+e._s(e.$t("Update {entity}",{entity:e.$t("Password")}))+"\n    ")]),t("q-card-section",{staticClass:"q-mb-md"},[t("div",{staticClass:"row q-col-gutter-sm"},[t("div",{staticClass:"col-xs-12"},[t("q-input",{attrs:{type:"password",label:e.$t("Password")+"*",filled:"",dense:"","stack-label":"",rules:e.rules.password,error:!!e.errors.password,"error-message":e.errors.password},model:{value:e.formEntry.password,callback:function(t){e.$set(e.formEntry,"password",t)},expression:"formEntry.password"}})],1),t("div",{staticClass:"col-xs-12"},[t("q-input",{attrs:{type:"password",label:e.$t("Confirm Password")+"*",filled:"",dense:"","stack-label":"",rules:e.rules.password_confirmation,error:!!e.errors.password_confirmation,"error-message":e.errors.password_confirmation},model:{value:e.formEntry.password_confirmation,callback:function(t){e.$set(e.formEntry,"password_confirmation",t)},expression:"formEntry.password_confirmation"}})],1)])]),t("q-separator"),t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{attrs:{label:e.$t("Cancel"),flat:"",disable:e.loading||e.isLoading},on:{click:e.cancel}}),t("q-btn",{staticClass:"q-px-lg",attrs:{type:"submit",label:e.$t("Update"),color:"primary",loading:e.loading||e.isLoading,unelevated:""}})],1)],1)],1)},I=[],R={name:null,password:null,password_confirmation:null},M={name:"FormEntry",props:{loading:Boolean,closable:{type:Boolean,default:!0},entry:{type:Object,default:function(){return R}},asView:{type:Boolean,default:!1}},data:function(){var e=this;return{formEntry:R,isLoading:!1,rules:{name:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Name")})}],email:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Email")})},function(t){return!!t&&e.$utils.isEmail(t)||e.$t("{field} is invalid",{field:e.$t("Email")})}],password:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Password")})},function(t){return t&&t.length>=6||e.$t("{field} must be at least {length} characters",{field:e.$t("Password"),length:6})}],password_confirmation:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Password confirmation")})},function(t){return t===e.formEntry.password||e.$t("{field} does not match",{field:e.$t("Password confirmation")})}]},errors:R}},computed:{isCreate:function(){return!this.formEntry.id}},watch:{entry:{immediate:!0,handler:function(e){var t=this;this.$nextTick((function(){t.fill(e)}))}}},methods:{fill:function(e){e=l()(l()({},R),e),this.formEntry=e,this.$refs.form.resetValidation()},onSubmit:function(){var e=this;return p()(d()().mark((function t(){var n,a,r,s;return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading&&!e.isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$refs.form.validate();case 4:if(n=t.sent,n){t.next=7;break}return t.abrupt("return");case 7:return a={password:e.formEntry.password,password_confirmation:e.formEntry.password_confirmation},e.isLoading=!0,t.prev=9,t.next=12,e.$api.patch("/v1/distribution-centers/".concat(e.formEntry.id),a);case 12:r=t.sent,s=r.data,"success"===s.status&&e.$emit("success"),"success"===s.status?e.$q.notify({message:e.$t("{entity} updated",{entity:e.$t("Password")})}):e.$t("Failed to update {entity}",{entity:e.$t("password")}),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](9),t.t0.validation?e.errors=l()(l()({},R),t.t0.validation.errors):e.$q.notify(t.t0);case 21:e.isLoading=!1;case 22:case"end":return t.stop()}}),t,null,[[9,18]])})))()},cancel:function(){this.loading||this.isLoading||this.$emit("cancel")}}},z=M,T=(n("e47f"),Object(g["a"])(z,Y,I,!1,null,"07c2423c",null)),N=T.exports;Q()(T,"components",{QCard:_["a"],QForm:$["a"],QCardSection:w["a"],QInput:C["a"],QSeparator:S["a"],QCardActions:F["a"],QBtn:k["a"]});var O=n("c1eb"),B=function(){var e=this,t=e._self._c;return t("q-card",{staticClass:"adapter-printer q-pa-sm"},[t("q-form",{ref:"form",staticClass:"q-gutter-md",attrs:{greedy:""},on:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)}}},[t("div",{staticClass:"text-h6 q-px-md q-pt-sm"},[e._v("\n      "+e._s(e.$t("Print"))+"\n    ")]),t("q-card-section",{staticClass:"q-mb-md scroll",staticStyle:{"max-height":"60vh"}},[e.isConnecting?t("div",{staticClass:"connect-loading"},[t("q-spinner-radio",{attrs:{color:"primary",size:"6.65em"}}),t("div",{staticClass:"info"},[e._v("\n          Connecting to available printer adapterâ€¦\n        ")])],1):e.connectErrorCode?t("div",{staticClass:"connect-error"},[t("q-icon",{attrs:{color:"negative",name:"error",size:"4.1em"}}),t("p",{staticClass:"info"},[99===e.connectErrorCode?[e._v("\n            Could not find printer adapter connection."),t("br"),e._v("Seems like no adapter open anywhere.\n          ")]:[e._v("\n            Failed to connect to any printer adapter.\n          ")]],2),t("div",{staticClass:"reconnect"},[t("q-btn",{attrs:{outline:"",color:"secondary"},on:{click:e.connect}},[e._v("\n            "+e._s(e.$t("Reconnect"))+"\n          ")])],1)],1):t("div",{staticClass:"printer-list"},[e.adapterFds.length?e._l(e.printers,(function(n,a){return t("div",{key:a,staticClass:"printer-item",class:{selected:e.selectedPrinter&&e.selectedPrinter.name===n.name},attrs:{role:"button",tabindex:a},on:{click:function(t){return t.preventDefault(),e.onPrinterSelected(n)}}},[t("div",{staticClass:"printer-item-inner"},[t("div",{staticClass:"printer-icon"},[t("q-icon",{attrs:{name:"print"}})],1),t("div",{staticClass:"printer-name"},[e._v("\n                "+e._s(n.name)+"\n              ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedPrinter&&e.selectedPrinter.name===a,expression:"selectedPrinter && selectedPrinter.name === i"}],staticClass:"icon-selected"},[t("q-icon",{attrs:{size:"xs",name:"check",color:"white"}})],1)])])})):t("div",{staticClass:"empty-fds"},[e._v("\n          Could not find printer adapter connection."),t("br"),e._v("Seems like no adapter open anywhere.\n        ")])],2),e.connectErrorCode?t("div",{staticClass:"troubleshoot"},[t("q-separator",{staticClass:"q-mb-lg"}),"id"===e.$q.lang.isoName?[t("ul",[t("li",[e._v("\n              Pastikan Anda telah membuka Aplikasi "),t("strong",[e._v("Invoice Printer Adapter")]),e._v(" di komputer lokal Anda yang sudah terhubung dengan perangkat printer.\n              "),e.appDownloadUrl?[e._v("\n                Anda dapat mengunduhnya "),t("a",{attrs:{href:e.appDownloadUrl,download:""}},[e._v("di sini")]),e._v(".\n              ")]:e._e()],2),t("li",[e._v("\n              Klik tombol "),t("strong",[e._v("Reconnect")]),e._v(", untuk menyambung ulang koneksi.\n            ")]),t("li",[e._v("\n              Jika kesalahan masih berlanjut, tutup aplikasi Invoice Printer Adapter sepenuhnya dan buka kembali. Pastikan aplikasi dapat mendeteksi/terhubung dengan perangkat printer.\n            ")])])]:[t("ul",[t("li",[e._v("\n              Make sure you have opened the "),t("strong",[e._v("Invoice Printer Adapter")]),e._v(" on your local computer that is connected to the printer device.\n              "),e.appDownloadUrl?[e._v("\n                You can download the adapter app "),t("a",{attrs:{href:e.appDownloadUrl,download:""}},[e._v("here")]),e._v(".\n              ")]:e._e()],2),t("li",[e._v("\n              Click the "),t("strong",[e._v("Reconnect")]),e._v(" button, to try to connect to the adapter again.\n            ")]),t("li",[e._v("\n              If the error still persists, close the Invoice Printer Adapter application completely and reopen it. Make sure the adapter app can detect/connect with the printer device.\n            ")])])]],2):e._e()]),t("q-separator"),t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{attrs:{label:e.connectErrorCode?e.$t("Close"):e.$t("Cancel"),flat:"",disable:e.loading||e.isLoading},on:{click:e.cancel}}),e.isConnecting||e.connectErrorCode?e._e():t("q-btn",{staticClass:"q-px-lg",attrs:{type:"submit",label:e.$t("Print"),color:"primary",loading:e.loading||e.isLoading,unelevated:""}})],1)],1)],1)},U=[],j=(n("e6cf"),n("159b"),n("7db0"),{name:"AdapterPrinter",props:{loading:Boolean,closable:{type:Boolean,default:!0},entries:{type:Array,default:function(){return[]}},visible:Boolean},data:function(){var e=this;return{isLoading:!1,rules:{name:[function(t){return!!t||e.$t("{field} is required",{field:e.$t("Name")})}]},errors:{},adapterFds:[],printers:[],selectedPrinter:null,isConnecting:!0,connectErrorCode:null,appDownloadUrl:this.$miscData.app_download,streamPrinterInterval:null}},watch:{visible:{immediate:!0,handler:function(e){var t=this;this.$nextTick((function(){t.selectedPrinter=null,t.adapterFds=[],t.printers=[],t.$ws.reset(),t.connect()}))}}},beforeDestroy:function(){var e=this;return p()(d()().mark((function t(){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$ws._closeFns=[],clearInterval(e.streamPrinterInterval),t.next=4,e.$ws.close();case 4:case"end":return t.stop()}}),t)})))()},methods:{connect:function(){var e=this;return p()(d()().mark((function t(){var n;return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$ws._closeFns=[],e.isConnecting=!0,t.next=4,e.connectWebsocket();case 4:if(n=t.sent,console.log({isConnected:n}),n){t.next=10;break}e.connectErrorCode=99,t.next=15;break;case 10:return e.connectErrorCode=null,e.$ws.onClose((function(){e.isConnected=!1,e.connectErrorCode=99})),t.next=14,e.$utils.delay(1e3);case 14:e.streamPrinters();case 15:e.isConnecting=!1;case 16:case"end":return t.stop()}}),t)})))()},connectWebsocket:function(){var e=this;return p()(d()().mark((function t(){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=null;e.$ws.onReady(function(){var t=p()(d()().mark((function t(n){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.send({mode:"get",id:"get:printer_adapter_fd",source:e.$ws.appSource});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.$ws.onceEvent("get","get:printer_adapter_fd:response",(function(a,r,s){e.adapterFds=s.adapter_fds||[];try{e.adapterFds.length?(e.$ws.onceEvent("get","get:printers",(function(a,r,s){clearTimeout(n),console.log("received get:printers"),e.printers=(s.printers||[]).map((function(e){return e.adapter_fd=s.adapter_fd,e})),e.printers.length?t(!0):t(!1)})),e.adapterFds.forEach((function(t){console.log("sending get:printers"),e.$ws.send({mode:"get",id:"get:printers",source:e.$ws.appSource,adapter_fd:t})}))):t(!1)}catch(a){console.error(a),t(!1)}})),e.$ws.connect(),n=setTimeout((function(){t(!1)}),25e3)})));case 1:case"end":return t.stop()}}),t)})))()},streamPrinters:function(){var e=this;return p()(d()().mark((function t(){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:clearInterval(e.streamPrinterInterval),setInterval((function(){e.adapterFds.length&&(e.adapterFds.forEach((function(t){e.$ws.send({mode:"get",id:"get:printers",source:e.$ws.appSource,adapter_fd:t})})),e.$ws.onceEvent("get","get:printers",(function(t,n,a){a.printers.length&&(e.printers=(a.printers||[]).map((function(e){return e.adapter_fd=a.adapter_fd,e})),e.selectedPrinter&&!e.printers.find((function(t){return t.name==e.selectedPrinter.name}))&&(e.selectedPrinter=null))})))}),2e4);case 2:case"end":return t.stop()}}),t)})))()},onPrinterSelected:function(e){this.selectedPrinter=e},onSubmit:function(){var e=this;return p()(d()().mark((function t(){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading&&!e.isLoading){t.next=2;break}return t.abrupt("return");case 2:if(e.selectedPrinter){t.next=5;break}return e.$q.notify({message:e.$t("Please select printer device first")}),t.abrupt("return");case 5:return e.isLoading=!0,e.$ws.send({mode:"action",id:"print:invoice",source:e.$ws.appSource,adapter_fd:e.selectedPrinter.adapter_fd,printer_name:e.selectedPrinter.name,invoices:e.entries.map((function(e){return e.id}))}),e.$q.notify({message:e.$t("The print command has been sent")}),t.next=10,e.$utils.delay(5e3);case 10:e.isLoading=!1,e.cancel();case 12:case"end":return t.stop()}}),t)})))()},cancel:function(){this.loading||this.isLoading||this.$emit("cancel")}}}),H=j,J=(n("0eb4"),n("9569")),K=n("0d59"),W=Object(g["a"])(H,B,U,!1,null,null,null),G=W.exports;Q()(W,"components",{QCard:_["a"],QForm:$["a"],QCardSection:w["a"],QSpinnerRadio:J["a"],QIcon:x["a"],QBtn:k["a"],QSeparator:S["a"],QCardActions:F["a"],QSpinner:K["a"]});var X=n("05c2"),Z={name:"PageInvoice",components:{FormEntry:L,FormPassword:N,InvoiceStatusChip:O["a"],AdapterPrinter:G},meta:function(){return{title:this.$t("Invoices")+" - "+this.$t("Web Console")}},breadcrumbs:function(){return["home",{text:this.$t("Invoices")}]},mixins:[X["a"]],data:function(){var e=this,t={fuzzy:{value:null}};return{entries:[],selectedEntries:[],columns:[{name:"id",field:"id",label:"#",realLabel:this.$t("ID"),align:"left",style:"max-width: 25px",headerClasses:"table-header-id",classes:"table-cell-id",sortable:!0},{name:"customer_name",field:"customer_name",label:this.$t("Customer"),headerClasses:"table-header-customer_name",classes:"table-cell-customer_name",align:"left",sortable:!0},{name:"invoice_no",field:"invoice_no",label:this.$t("Invoice No"),headerClasses:"table-header-invoice_no",classes:"table-cell-invoice_no",align:"left",sortable:!0},{name:"receipt_no",field:"receipt_no",label:this.$t("Receipt No"),headerClasses:"table-header-receipt_no",classes:"table-cell-receipt_no",align:"left",sortable:!0},{name:"status",field:"status",label:this.$t("Status"),headerClasses:"table-header-status",classes:"table-cell-status",align:"left",sortable:!0},{name:"ppn_total",field:"ppn_total",format:function(t){return e.$utils.currency(t,{decimal:".",thousand:","})||0},label:this.$t("VAT"),headerClasses:"table-header-ppn_total",classes:"table-cell-ppn_total",align:"left",sortable:!0},{name:"stamp_duty",field:"stamp_duty",format:function(t){return e.$utils.currency(t,{decimal:".",thousand:","})||0},label:this.$t("Stamp Duty"),headerClasses:"table-header-stamp_duty",classes:"table-cell-stamp_duty",align:"left",sortable:!0},{name:"sub_total",field:"sub_total",format:function(t){return e.$utils.currency(t,{decimal:".",thousand:","})},label:this.$t("Sub Total"),headerClasses:"table-header-sub_total",classes:"table-cell-sub_total",align:"left",sortable:!0},{name:"total",field:"total",format:function(t){return e.$utils.currency(t,{decimal:".",thousand:","})},label:this.$t("Total"),headerClasses:"table-header-total",classes:"table-cell-total",align:"left",sortable:!0},{name:"due_at",field:"due_at",label:this.$t("Term of Payment"),align:"left",headerClasses:"table-header-due_at",classes:"table-cell-due_at",format:function(e){return m["b"].formatDate(e,"DD MMM YYYY")},sortable:!0},{name:"published_at",field:"published_at",label:this.$t("Published At"),align:"left",headerClasses:"table-header-published_at",classes:"table-cell-published_at",format:function(e){return m["b"].formatDate(e,"DD MMM YYYY")},sortable:!0},{name:"created_at",field:"created_at",label:this.$t("Created At"),align:"left",headerClasses:"table-header-created_at",classes:"table-cell-created_at",format:function(e){return m["b"].formatDate(e,"DD MMM YYYY HH:mm")},sortable:!0},{name:"action",label:"",align:"right",headerClasses:"table-header-action",classes:"table-cell-action",required:!0}],visibleColumns:["id","customer_name","invoice_no","status","ppn_total","stamp_duty","sub_total","total","due_at","published_at","created_at"],isLoading:!1,isExporting:!1,isAdvancedSearchVisible:!1,isFormEntryVisible:!1,isFormEntryReadonly:!1,isFormPasswordVisible:!1,isAdapterPrinterVisible:!1,formEntry:{},formPassword:{},pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:15,rowsNumber:0},search:t,advancedSearch:t,exportUrl:null}},mounted:function(){var e=this;return p()(d()().mark((function t(){return d()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.onRequest();case 2:return t.next=4,e.$nextTick();case 4:case"end":return t.stop()}}),t)})))()},methods:{onRequest:function(e){var t=this;return p()(d()().mark((function n(){var a,r,s;return d()().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.isLoading){n.next=2;break}return n.abrupt("return");case 2:return e||(e={pagination:t.pagination}),t.isLoading=!0,a={table_pagination:l()({},e.pagination||{}),table_search:l()({},t.search)},n.prev=5,n.next=8,t.$api.get("/v1/invoices",{params:a});case 8:r=n.sent,s=r.data,"success"===s.status&&(t.entries=s.data.invoices,t.pagination=l()(l()({},t.pagination),s.pagination)),n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](5),t.$q.notify(n.t0);case 16:t.isLoading=!1;case 17:case"end":return n.stop()}}),n,null,[[5,13]])})))()},onAdvancedSearch:function(){this.advancedSearch=JSON.parse(JSON.stringify(this.search)),this.isAdvancedSearchVisible=!0},onAdvancedSearchSubmit:function(){this.search=this.$utils.merge({},this.advancedSearch),this.onRequest(),this.isAdvancedSearchVisible=!1},onFormEntryCreate:function(){this.$router.push("/invoices/create"),this.formEntry={},this.isFormEntryReadonly=!1,this.isFormEntryVisible=!1},onFormEntrySuccess:function(){this.isFormEntryReadonly=!1,this.isFormEntryVisible=!1,this.onRequest()},onFormEntryCancel:function(){this.isFormEntryReadonly=!1,this.isFormEntryVisible=!1},onFormPasswordSuccess:function(){this.isFormPasswordVisible=!1},onFormPasswordCancel:function(){this.isFormPasswordVisible=!1},onAdapterPrinterSuccess:function(){this.isAdapterPrinterVisible=!1},onAdapterPrinterCancel:function(){this.isAdapterPrinterVisible=!1},onView:function(e){this.$router.push("/invoices/".concat(e.id)),this.formEntry=l()({},e),this.isFormEntryReadonly=!0,this.isFormEntryVisible=!1},onEdit:function(e){this.formEntry=l()({},e),this.isFormEntryReadonly=!1,this.isFormEntryVisible=!0},onEditPassword:function(e){this.formPassword=l()({},e),this.isFormPasswordVisible=!0},onSelection:function(e){var t=this,n=e.rows,a=e.added,r=e.evt;if(1===n.length&&void 0!==r){var s=this.oldSelectedRow,o=i()(n,1),l=o[0],c=(r.ctrlKey,r.shiftKey);!0!==c&&(this.oldSelectedRow=l),this.$nextTick((function(){if(!0===c){var e=t.$refs.table.filteredSortedRows,n=e.indexOf(s),r=e.indexOf(l);if(n<0&&(n=0),n>r){var i=[r,n];n=i[0],r=i[1]}var o=e.slice(n,r+1);t.selectedEntries=!0===a?t.selectedEntries.concat(o.filter((function(e){return!1===t.selectedEntries.includes(e)}))):t.selectedEntries.filter((function(e){return!1===o.includes(e)}))}}))}},onDelete:function(e){var t=this;this.isLoading||this.$q.dialog({title:this.$t("Confirm"),message:this.$t("Are you sure want to delete this {entity}?",{entity:this.$t("invoice")}),cancel:{label:this.$t("Cancel"),color:"dark",flat:!0},ok:{label:this.$t("Yes"),color:"primary",unelevated:!0,flat:!0,class:"text-weight-bold"},persistent:!0}).onOk(p()(d()().mark((function n(){var a,r;return d()().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$api.delete("/v1/invoices/".concat(e.id));case 3:a=n.sent,r=a.data,r.message?(t.$q.notify({message:r.message}),t.onRequest()):"success"===r.status?(t.$q.notify({message:t.$t("{entity} deleted",{entity:t.$t("Invoice")})}),t.onRequest()):t.$t("Failed to delete {entity}",{entity:t.$t("invoice")}),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$q.notify(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))).onCancel((function(){t.isLoading=!1}))},onFormEntryExport:function(e){var t=this;return p()(d()().mark((function n(){var a,r;return d()().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.isLoading&&!t.isExporting){n.next=2;break}return n.abrupt("return",!1);case 2:return e||(e={pagination:t.pagination}),t.isLoading=!0,t.isExporting=!0,a={table_pagination:l()({},e.pagination||{}),table_search:l()({},t.search),ext:e.ext||"xlsx"},r=function(){var e=p()(d()().mark((function e(){var n,s,i,o=arguments;return d()().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:0,e.next=3,t.$api.post("/v1/invoices/export",t.$api.defaults.paramsTransformer(a));case 3:if(s=e.sent,i=s.data,"success"!==i.status){e.next=15;break}return t.exportUrl=i.data.url,console.log(t.exportUrl),e.next=10,t.$utils.delay(100);case 10:return t.$refs.exportHiddenLink.click(),e.next=13,t.$utils.delay(3e3);case 13:e.next=19;break;case 15:if(!i.data.wait){e.next=19;break}return e.next=18,t.$utils.delay(15e3);case 18:return e.abrupt("return",r(n+1));case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.prev=7,n.next=10,r();case 10:n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](7),t.$q.notify(n.t0);case 15:t.isLoading=!1,t.isExporting=!1,t.exportUrl=null;case 18:case"end":return n.stop()}}),n,null,[[7,12]])})))()}}},ee=Z,te=(n("0667"),n("9989")),ne=n("6ac5"),ae=n("65c6"),re=n("05c0"),se=n("4e73"),ie=n("9f0a"),oe=n("eaac"),le=n("8f8e"),ce=n("db86"),de=n("24e8"),ue=Object(g["a"])(ee,a,r,!1,null,null,null);t["default"]=ue.exports;Q()(ue,"components",{QPage:te["a"],QBtn:k["a"],QToolbarTitle:ne["a"],QCard:_["a"],QToolbar:ae["a"],QInput:C["a"],QTooltip:re["a"],QMenu:se["a"],QOptionGroup:ie["a"],QTable:oe["a"],QCheckbox:le["a"],QTd:ce["a"],QIcon:x["a"],QDialog:de["a"],QForm:$["a"],QCardSection:w["a"],QSeparator:S["a"],QCardActions:F["a"]}),Q()(ue,"directives",{ClosePopup:D["a"]})},dfde:function(e,t,n){"use strict";n("9954")},e47f:function(e,t,n){"use strict";n("edb5")},edb5:function(e,t,n){}}]);